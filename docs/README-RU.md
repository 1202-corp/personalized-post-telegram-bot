# Personalized Post Bot - Сервисы ботов

> [English version](../README.md)

Эта директория содержит два сервиса ботов, которые работают вместе для предоставления персонализированных рекомендаций постов в Telegram.

## Компоненты

### Main Bot (`main-bot/`)

Telegram бот на Aiogram 3.x с AARRR воронкой для персонализированных рекомендаций постов.

**Основные функции:**
- Онбординг и обучение пользователей
- Персонализированная лента на основе ML-рекомендаций
- Интеграция с MiniApp для swipe интерфейса
- Retention сервис для неактивных пользователей
- Мультиязычность (en/ru)
- Управление сообщениями через registry pattern

**Технологии:**
- Aiogram 3.x — Фреймворк для Telegram Bot API
- FSM (MemoryStorage) — Управление состояниями пользователей
- httpx — HTTP клиент для коммуникации с API

**Документация:** [main-bot/README.md](../main-bot/README.md)

### User Bot (`user-bot/`)

Telethon-based скрейпер с HTTP API для скрейпинга Telegram каналов и синхронизации постов с основным API.

**Основные функции:**
- Скрейпинг постов из каналов
- Присоединение к каналам
- Скачивание медиа файлов (фото, видео)
- Автоматическая синхронизация с основным API
- Health checks

**Технологии:**
- Telethon — MTProto клиент для Telegram
- FastAPI — HTTP API фреймворк
- Session String — Авторизация без интерактивного входа

**Документация:** [user-bot/README.md](../user-bot/README.md)

## Архитектура

Два бота работают вместе в следующем потоке:

1. **Main Bot** получает команды пользователей и запрашивает персонализированные посты
2. **Main Bot** вызывает **API** для получения рекомендаций
3. Если нужны новые посты, **Main Bot** запускает **User Bot** для скрейпинга каналов
4. **User Bot** скрейпит посты из Telegram каналов и синхронизирует их с **API**
5. **Main Bot** доставляет персонализированную ленту пользователям на основе ML-рекомендаций

